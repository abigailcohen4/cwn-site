import{ck as D,cl as E,cm as w,cn as I,b7 as c,co as f,cp as R,cq as g,cr as A,cs as F,ct as m,cu as T,cv as b,cw as O}from"./index-CndJoalP.js";function j(t,a,e=null){const n=[],l=a.mapPositions;d(a,n);const o=n[0][1].data,u=n[0][1].indices.length,r=E(u);return v(a,n,r),U(a,n,r),y(a,n,r),S(a,n,r),C(a,n,r),z(a,n,r),L(a,n,o),new w(t,n,l,I.Line,e)}function d(t,a){const{attributeData:{position:e},removeDuplicateStartEnd:n}=t,l=N(e)&&n,o=e.length/3-(l?1:0),u=new Array(2*(o-1)),r=l?e.slice(0,-3):e;let i=0;for(let p=0;p<o-1;p++)u[i++]=p,u[i++]=p+1;a.push([c.POSITION,new f(r,u,3,l)])}function v(t,a,e){if(t.attributeData.colorFeature!=null)return;const n=t.attributeData.color;a.push([c.COLOR,new f(n??R,e,4)])}function y(t,a,e){t.attributeData.normal&&a.push([c.NORMAL,new f(t.attributeData.normal,e,3)])}function S(t,a,e){t.attributeData.colorFeature!=null&&a.push([c.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],e,1,!0)])}function U(t,a,e){t.attributeData.sizeFeature==null&&a.push([c.SIZE,new f([t.attributeData.size??1],e,1,!0)])}function C(t,a,e){t.attributeData.sizeFeature!=null&&a.push([c.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],e,1,!0)])}function z(t,a,e){t.attributeData.opacityFeature!=null&&a.push([c.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],e,1,!0)])}function L(t,a,e){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==g.Global||!t.overlayInfo.spatialReference.isGeographic)return;const n=D(e.length),l=A(t.overlayInfo.spatialReference);for(let s=0;s<n.length;s+=3)F(e,s,n,s,l);const o=e.length/3,u=m(o+1);let r=B,i=G,p=0,h=0;T(r,n[h++],n[h++]),h++,u[0]=0;for(let s=1;s<o+1;++s)s===o&&(h=0),T(i,n[h++],n[h++]),h++,p+=O(r,i),u[s]=p,[r,i]=[i,r];a.push([c.DISTANCETOSTART,new f(u,a[0][1].indices,1,!0)])}function N(t){const a=t.length;return t[0]===t[a-3]&&t[1]===t[a-2]&&t[2]===t[a-1]}const B=b(),G=b();function M(t,a){if(t==null||t.length===0)return[];const e=[];return t.forEach(n=>{const l=n.length,o=D(3*l);n.forEach((r,i)=>{o[3*i]=r[0],o[3*i+1]=r[1],o[3*i+2]=r[2]});const u={attributeData:{position:o,normal:a},removeDuplicateStartEnd:!1};e.push(u)}),e}export{M as R,j as b};
