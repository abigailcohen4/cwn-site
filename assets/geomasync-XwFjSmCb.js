const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/unitConversion-BNXUKT2T.js","assets/index-Dg9B7iOH.js","assets/index-DY6e7BdP.css"])))=>i.map(i=>d[i]);
import{il as d,es as y,im as v,io as p,aE as R,aG as E,_ as W,aH as b,j as x,aF as X,aj as z,ip as B}from"./index-Dg9B7iOH.js";import{F as f,z as O,J as V,u as m,K as H,M as G,y as M,g as J,A as Z,B as L,N as q,O as U,P as Y,R as k,b as P,Z as T,Q as j,S as $,T as nn,V as en,X as K,C as D,$ as C}from"./arcade-BHsgsu2P.js";import{a as o,r as s}from"./unitConversion-BNXUKT2T.js";import{l as Q}from"./portalUtils-BcmLNiui.js";import{a as u}from"./operatorsWorkerConnection-D0lOZYvj.js";import"./shared-DCoEkjs9.js";import"./number-CqzmR4Ei.js";import"./WhereClause-4KbTaCNC.js";import"./hash-CcEbRgUF.js";function g(a){if(a==null)return a;switch(typeof a){case"string":case"number":return a;default:throw new o(null,s.InvalidParameter,null)}}function dn(a){a.mode==="async"&&(a.functions.disjoint=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(n=f(n),O(n,e,t),n[0]===null||n[1]===null||u("disjoint",[n[0].toJSON(),n[1].toJSON()])))},a.functions.intersects=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(n=f(n),O(n,e,t),n[0]!==null&&n[1]!==null&&u("intersects",[n[0].toJSON(),n[1].toJSON()])))},a.functions.touches=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(n=f(n),O(n,e,t),n[0]!==null&&n[1]!==null&&u("touches",[n[0].toJSON(),n[1].toJSON()])))},a.functions.crosses=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(n=f(n),O(n,e,t),n[0]!==null&&n[1]!==null&&u("crosses",[n[0].toJSON(),n[1].toJSON()])))},a.functions.within=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(n=f(n),O(n,e,t),n[0]!==null&&n[1]!==null&&u("within",[n[0].toJSON(),n[1].toJSON()])))},a.functions.contains=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(n=f(n),O(n,e,t),n[0]!==null&&n[1]!==null&&u("contains",[n[0].toJSON(),n[1].toJSON()])))},a.functions.overlaps=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(n=f(n),O(n,e,t),n[0]!==null&&n[1]!==null&&u("overlaps",[n[0].toJSON(),n[1].toJSON()])))},a.functions.equals=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(m(n,2,2,e,t),n[0]===n[1]||(n[0]instanceof d&&n[1]instanceof d?u("equals",[n[0].toJSON(),n[1].toJSON()]):(V(n[0])&&V(n[1])||!!(H(n[0])&&H(n[1])||G(n[0])&&G(n[1])))&&n[0].equals(n[1]))))},a.functions.relate=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=f(n),m(n,3,3,e,t),n[0]instanceof d&&n[1]instanceof d)return u("relate",[n[0].toJSON(),n[1].toJSON(),M(n[2])]);if(n[0]instanceof d&&n[1]===null||n[1]instanceof d&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new o(e,s.InvalidParameter,t)})},a.functions.intersection=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>(n=f(n),O(n,e,t),n[0]===null||n[1]===null?null:y(await u("intersection",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.union=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if((n=f(n)).length===0)throw new o(e,s.WrongNumberOfParameters,t);const r=[];if(n.length===1)if(v(n[0])){for(const i of f(n[0]))if(i!==null){if(!(i instanceof d))throw new o(e,s.InvalidParameter,t);r.push(i.toJSON())}}else{if(!J(n[0])){if(n[0]instanceof d)return Z(p(n[0]),e.spatialReference);if(n[0]===null)return null;throw new o(e,s.InvalidParameter,t)}for(const i of f(n[0].toArray()))if(i!==null){if(!(i instanceof d))throw new o(e,s.InvalidParameter,t);r.push(i.toJSON())}}else for(const i of n)if(i!==null){if(!(i instanceof d))throw new o(e,s.InvalidParameter,t);r.push(i.toJSON())}return r.length===0?null:y(await u("union",[r]))})},a.functions.difference=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>(n=f(n),O(n,e,t),n[0]===null?null:n[1]===null?p(n[0]):y(await u("difference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.symmetricdifference=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>(n=f(n),O(n,e,t),n[0]===null&&n[1]===null?null:n[0]===null?p(n[1]):n[1]===null?p(n[0]):y(await u("symmetricDifference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.clip=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,2,e,t),!(n[1]instanceof R)&&n[1]!==null)throw new o(e,s.InvalidParameter,t);if(n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);return n[1]===null?null:y(await u("clip",[n[0].toJSON(),n[1].toJSON()]))})},a.functions.cut=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,2,e,t),!(n[1]instanceof E)&&n[1]!==null)throw new o(e,s.InvalidParameter,t);if(n[0]===null)return[];if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);return n[1]===null?[p(n[0])]:(await u("cut",[n[0].toJSON(),n[1].toJSON()])).map(r=>y(r))})},a.functions.area=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(m(n,1,2,e,t),n=f(n),L(n[0])){const i=await n[0].sumArea(g(n[1]),!1,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,t);return i}let r=n[0];if((v(r)||J(r))&&(r=q(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof d))throw new o(e,s.InvalidParameter,t);return u("area",[r.toJSON(),g(n[1])])})},a.functions.areageodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(m(n,1,2,e,t),n=f(n),L(n[0])){const i=await n[0].sumArea(g(n[1]),!0,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,t);return i}let r=n[0];if((v(n[0])||J(n[0]))&&(r=q(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof d))throw new o(e,s.InvalidParameter,t);return u("geodeticArea",[r.toJSON(),g(n[1])])})},a.functions.length=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(m(n,1,2,e,t),n=f(n),L(n[0])){const i=await n[0].sumLength(g(n[1]),!1,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,t);return i}let r=n[0];if((v(n[0])||J(n[0]))&&(r=U(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof d))throw new o(e,s.InvalidParameter,t);return u("length",[r.toJSON(),g(n[1])])})},a.functions.length3d=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(m(n,1,2,e,t),(n=f(n))[0]===null)return 0;let r=n[0];if((v(n[0])||J(n[0]))&&(r=U(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof d))throw new o(e,s.InvalidParameter,t);if(r.hasZ===!0){const{convertFromSpatialReferenceUnit:i,toLengthUnit:w}=await W(()=>import("./unitConversion-BNXUKT2T.js").then(N=>N.e),__vite__mapDeps([0,1,2])),h=Y(r);return i(r.spatialReference,w(n[1]),h)}return u("length",[r.toJSON(),g(n[1])])})},a.functions.lengthgeodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(m(n,1,2,e,t),n=f(n),L(n[0])){const i=await n[0].sumLength(g(n[1]),!0,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,t);return i}let r=n[0];if((v(n[0])||J(n[0]))&&(r=U(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof d))throw new o(e,s.InvalidParameter,t);return u("geodeticLength",[r.toJSON(),g(n[1])])})},a.functions.distance=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{n=f(n),m(n,2,3,e,t);let r=n[0];if((v(n[0])||J(n[0]))&&(r=k(n[0],e.spatialReference)),!(r instanceof d))throw new o(e,s.InvalidParameter,t);let i=n[1];if((v(n[1])||J(n[1]))&&(i=k(n[1],e.spatialReference)),!(i instanceof d))throw new o(e,s.InvalidParameter,t);return u("distance",[r.toJSON(),i.toJSON(),g(n[2])])})},a.functions.distancegeodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{n=f(n),m(n,2,3,e,t);const r=n[0];if(!(r instanceof b))throw new o(e,s.InvalidParameter,t);const i=n[1];if(!(i instanceof b))throw new o(e,s.InvalidParameter,t);const w=new E({paths:[],spatialReference:r.spatialReference});return w.addPath([r,i]),u("geodeticLength",[w.toJSON(),g(n[2])])})},a.functions.densify=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);if(r<=0)throw new o(e,s.InvalidParameter,t);switch(n[0].type){case"polygon":case"polyline":case"extent":return y(await u("densify",[n[0].toJSON(),r,g(n[2])]));default:return n[0]}})},a.functions.densifygeodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);if(r<=0)throw new o(e,s.InvalidParameter,t);switch(n[0].type){case"polygon":case"polyline":case"extent":return y(await u("geodeticDensify",[n[0].toJSON(),r,g(n[2])]));default:return n[0]}})},a.functions.generalize=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,4,e,t),n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);const i=T(j(n[2],!0));return y(await u("generalize",[n[0].toJSON(),r,g(n[3]),{removeDegenerateParts:i}]))})},a.functions.buffer=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);return r===0?p(n[0]):y(await u("buffer",[n[0].toJSON(),r,g(n[2])]))})},a.functions.buffergeodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);return r===0?p(n[0]):y(await u("geodesicBuffer",[n[0].toJSON(),r,g(n[2])]))})},a.functions.offset=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,6,e,t),n[0]===null)return null;if(!(n[0]instanceof x||n[0]instanceof E))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);const i=M(n[3]??"round").toLowerCase();let w;switch(i){case"round":case"bevel":case"miter":case"square":w=i;break;default:w="round"}const h=P(j(n[4],10));if(isNaN(h))throw new o(e,s.InvalidParameter,t);const N=P(j(n[5],0));if(isNaN(N))throw new o(e,s.InvalidParameter,t);return y(await u("offset",[n[0].toJSON(),r,g(n[2]),{joins:w,miterLimit:h,flattenError:N}]))})},a.functions.rotate=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{var h;if(n=f(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);const r=n[0]instanceof R?x.fromExtent(n[0]):n[0],i=P(n[1]);if(isNaN(i))throw new o(e,s.InvalidParameter,t);const w=j(n[2],null);if(w===null){const N=r.type==="point"?r:(h=r.extent)==null?void 0:h.center;return y(await u("rotate",[r.toJSON(),i,N==null?void 0:N.x,N==null?void 0:N.y]))}if(w instanceof b)return y(await u("rotate",[r.toJSON(),i,w.x,w.y]));throw new o(e,s.InvalidParameter,t)})},a.functions.centroid=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,1,2,e,t),n[0]===null)return null;const r=M(n[1]??"geometric").toLowerCase();if(r!=="geometric"&&r!=="labelpoint")throw new o(e,s.InvalidParameter,t);let i=n[0];if((v(n[0])||J(n[0]))&&(i=r==="geometric"?k(n[0],e.spatialReference):q(n[0],e.spatialReference),i===null))return null;if(!(i instanceof d))throw new o(e,s.InvalidParameter,t);return y(r==="geometric"?await u("centroid",[i.toJSON()]):await u("labelPoint",[i.toJSON()]))})},a.functions.measuretocoordinate=function(e,t){return a.standardFunctionAsync(e,t,$)},a.functions.pointtocoordinate=function(e,t){return a.standardFunctionAsync(e,t,nn)},a.functions.distancetocoordinate=function(e,t){return a.standardFunctionAsync(e,t,en)},a.functions.multiparttosinglepart=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,1,1,e,t),n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);if(n[0]instanceof b)return[Z(p(n[0]),e.spatialReference)];if(n[0]instanceof R)return[Z(p(n[0]),e.spatialReference)];const r=y(await u("simplify",[n[0].toJSON()]));if(r instanceof x){const i=[],w=[];for(let h=0;h<r.rings.length;h++)if(r.isClockwise(r.rings[h])){const N=y({rings:[r.rings[h]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(N)}else w.push({ring:r.rings[h],pt:r.getPoint(h,0)});for(let h=0;h<w.length;h++)for(let N=0;N<i.length;N++)if(i[N].contains(w[h].pt)){i[N].addRing(w[h].ring);break}return i}if(r instanceof E){const i=[];for(let w=0;w<r.paths.length;w++){const h=y({paths:[r.paths[w]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(h)}return i}if(n[0]instanceof X){const i=[],w=Z(p(n[0]),e.spatialReference);for(let h=0;h<w.points.length;h++)i.push(w.getPoint(h));return i}return null})},a.functions.issimple=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=f(n),m(n,1,1,e,t),n[0]===null)return!0;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);return u("isSimple",[n[0].toJSON()])})},a.functions.simplify=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,1,1,e,t),n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);return y(await u("simplify",[n[0].toJSON()]))})},a.functions.convexhull=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,1,1,e,t),n[0]===null)return null;if(!(n[0]instanceof d))throw new o(e,s.InvalidParameter,t);return y(await u("convexHull",[n[0].toJSON()]))})},a.functions.getuser=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{var h,N;m(n,0,2,e,t);let r=j(n[1],""),i=r===!0;if(r=r===!0||r===!1?"":M(r),n.length===0||n[0]instanceof K){let I;I=(h=e.services)!=null&&h.portal?e.services.portal:z.getDefault(),n.length>0&&(I=Q(n[0],I));const F=await B(I,r,i);if(F){const A=JSON.parse(JSON.stringify(F));for(const S of["lastLogin","created","modified"])A[S]!==void 0&&A[S]!==null&&(A[S]=new Date(A[S]));return D.convertObjectToArcadeDictionary(A,C(e))}return null}let w=null;if(L(n[0])&&(w=n[0]),w){if(i=!1,r)return null;await w.load();const I=await w.getOwningSystemUrl();if(!I){if(!r){const S=await w.getIdentityUser();return S?D.convertObjectToArcadeDictionary({username:S},C(e)):null}return null}let F;F=(N=e.services)!=null&&N.portal?e.services.portal:z.getDefault(),F=Q(new K(I),F);const A=await B(F,r,i);if(A){const S=JSON.parse(JSON.stringify(A));for(const _ of["lastLogin","created","modified"])S[_]!==void 0&&S[_]!==null&&(S[_]=new Date(S[_]));return D.convertObjectToArcadeDictionary(S,C(e))}return null}throw new o(e,s.InvalidParameter,t)})},a.functions.nearestcoordinate=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,2,e,t),!(n[0]instanceof d||n[0]===null))throw new o(e,s.InvalidParameter,t);if(!(n[1]instanceof b||n[1]===null))throw new o(e,s.InvalidParameter,t);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof R?x.fromExtent(n[0]):n[0],i=await u("getNearestCoordinate",[r.toJSON(),n[1].toJSON(),{calculateLeftRightSide:!0}]);return i===null?null:D.convertObjectToArcadeDictionary({coordinate:y(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.rightSide?"right":"left"},C(e),!1,!0)})},a.functions.nearestvertex=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=f(n),m(n,2,2,e,t),!(n[0]instanceof d||n[0]===null))throw new o(e,s.InvalidParameter,t);if(!(n[1]instanceof b||n[1]===null))throw new o(e,s.InvalidParameter,t);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof R?x.fromExtent(n[0]):n[0],i=await u("getNearestVertex",[r.toJSON(),n[1].toJSON()]);return i===null?null:D.convertObjectToArcadeDictionary({coordinate:y(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.rightSide?"right":"left"},C(e),!1,!0)})})}export{dn as registerFunctions};
