const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DSua8dRv.js","assets/index-CRagaFio.js","assets/index-CndJoalP.js","assets/index-DHNSHnXL.css","assets/guid-BDWAkmkV.js","assets/useT9n-DZms8McR.js","assets/index-QBdcCKqQ.js","assets/dom-DFP8hne0.js","assets/observers-D6xF50uF.js","assets/logger-Dd_zgwey.js","assets/keyed-m3ZevlHc.js","assets/directive-helpers-BkNxo9Xw.js","assets/ref-CTJLGHjK.js","assets/interactive-DC1kVWUv.js","assets/component-CHaAliv1.js","assets/index-BhzU_LgF.js","assets/index-w53CkBmw.js","assets/floating-ui-5Gfe90jR.js","assets/debounce-DbkufipY.js","assets/openCloseComponent-D9dGTuLc.js","assets/static-CzVUOrrY.js","assets/FloatingArrow-BSTGr2Zz.js","assets/useFocusTrap-C-W-aWP7.js","assets/key-ak3_eHKH.js","assets/index-DMfkEz2N.js","assets/array-CItZ4bXf.js","assets/index-B3okr6Kz.js","assets/ExpandToggle-tmAvN7KS.js","assets/index-Duq0jvYY.js","assets/label-C6KjxWoP.js","assets/index-CQR84glj.js","assets/index-BhCku7kx.js","assets/global-COGzFrr0.js","assets/index-BH0h3M5P.js","assets/customElement-B1LOUJxM.js","assets/customElement-Cao9eTjT.js","assets/live--JcL912S.js","assets/form-D5i2XLZ3.js","assets/Validation-DYy3CX1_.js","assets/input-Ceuqybnm.js","assets/index-B8IgFtlE.js","assets/locale-BZ36-s7O.js","assets/index-CyoV5gST.js","assets/core-Cxbbqyjy.js","assets/repeat-DhkHIfUT.js","assets/math-xemqatnM.js","assets/throttle-DCm6gPaM.js"])))=>i.map(i=>d[i]);
import{bc as ce,aH as R,J as v,r as s,m as a,bd as de,a as M,g as Z,hT as l,aD as k,e as G,az as pe,bG as he,bI as X,b2 as ue,sI as Y,b0 as ge,q as me,D as E,u as D,d$ as ve,e2 as W,e3 as _e,p as ye,en as ee,em as fe,e4 as N,dj as B,eq as be,jw as we,qN as Se,sJ as te,P as Ce,hS as $e,sK as Me,_ as S,hV as q,h$ as Pe,pd as xe,sL as I,sM as Ie,qQ as F}from"./index-CndJoalP.js";import{e as Te}from"./defaultUnit-DNYJIcyb.js";import{t as Ee,l as Re,f as ke,u as Le}from"./gridUtils-BDKqBfP1.js";import{DrawGraphicTool2D as Oe}from"./editingTools-CECbDj8P.js";import{x as Ge}from"./TextOverlayItem-CKbXrta6.js";import{r as De}from"./number-BCdyH1rJ.js";import{P as Ae,a as Ve,T as je,E as Ue,v as We,M as Ne,p as Be,k as qe}from"./SketchTooltipInfo-DrO5xvRy.js";import"./quantityFormatUtils-Dh1jti50.js";import"./SnappingVisualizer2D-DV3UyHzF.js";import"./SnappingVisualizer-CfHsXjNt.js";import"./PointSnappingHint-PnBChR9-.js";import"./editPlaneUtils-CeKFvHBn.js";import"./dehydratedFeatureComparison-D3CZZV2Q.js";import"./drawSurfaces-DTQ_XjSa.js";import"./geometryEngine-CATEj9O-.js";import"./geometryEngineBase-B0ZyeKAX.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./hydrated-CutWgio_.js";import"./mat2df64-CBKYtunK.js";import"./memoize-DmxaQ-k8.js";import"./EditGeometryOperations-DYdgCIrk.js";import"./InteractiveToolBase-CpHDWSwB.js";import"./SnappingContext-lR2hMWGP.js";import"./SnappingOperation-By0ppONY.js";import"./helpMessageUtils3d-BJvy3Gdj.js";import"./automaticAreaMeasurementUtils-CP7i0aV5.js";import"./geodesicLengthMeasurementUtils-Dh47MIQB.js";import"./euclideanAreaMeasurementUtils-CwoyMAAm.js";import"./automaticLengthMeasurementUtils-Bmme871o.js";import"./GraphicManipulator-BKdNTKOW.js";import"./drawUtils-CXQzJ5DW.js";let _=class extends ce{constructor(t){super(t),this.center=new R,this.dynamicScaling=!0,this.majorLineColor=v.fromArray([115,115,115,1]),this.majorLineInterval=10,this.minorLineColor=v.fromArray([165,165,165,1]),this.rotateWithMap=!1,this.rotation=0,this.spacing=1,this.type="measured",this.units="miles"}};s([a()],_.prototype,"center",void 0),s([a()],_.prototype,"dynamicScaling",void 0),s([a()],_.prototype,"majorLineColor",void 0),s([a()],_.prototype,"majorLineInterval",void 0),s([a()],_.prototype,"minorLineColor",void 0),s([a()],_.prototype,"rotateWithMap",void 0),s([a()],_.prototype,"rotation",void 0),s([a()],_.prototype,"spacing",void 0),s([de({measured:"measured"})],_.prototype,"type",void 0),s([a()],_.prototype,"units",void 0),_=s([M("esri.grids.MeasuredGrid")],_);let y=class extends Z{constructor(t){super(t),this.color=new v([255,127,0,1]),this.isDecoration=!0,this.length=34,this.rotation=0,this.thickness=2,this.visible=!0}get _strokeStyle(){return this.color.toCss(!0)}render(){const{x:t,y:e,length:i,thickness:r,rotation:n}=this,o=i/2,d=`0 0 ${i} ${i}`,p=`M${o} 0 V${i} M0 ${o} H${i}`;return l("div",{classes:{"esri-box-overlay-item":!0},dir:"ltr",styles:{left:`${(t??0)-o}px`,top:`${(e??0)-o}px`,width:`${i}px`,height:`${i}px`,transform:`rotate(${n}deg)`,visibility:this.visible?"visible":"hidden"}},l("svg",{styles:{overflow:"visible"},viewbox:d},l("path",{d:p,stroke:this._strokeStyle,"stroke-width":r})))}renderCanvas(){}};s([a()],y.prototype,"color",void 0),s([a()],y.prototype,"isDecoration",void 0),s([a()],y.prototype,"length",void 0),s([a()],y.prototype,"rotation",void 0),s([a()],y.prototype,"thickness",void 0),s([a()],y.prototype,"visible",void 0),s([a()],y.prototype,"x",void 0),s([a()],y.prototype,"y",void 0),s([a({readOnly:!0})],y.prototype,"_strokeStyle",null),y=s([M("esri.views.overlay.CrosshairOverlayItem")],y);const Fe=y;function He(t,e){const i=ie(e);return[t[0].toFixed(i),t[1].toFixed(i)]}function ie(t){return t>=500?6:t<500&&t>=50?7:t<50&&t>=5?8:9}function ze(t,e){const i=t.includes(",")?",":" ",[r,n,o]=t.split(i).map(p=>{const h=p.trim();return h?Number(h):null});if(!L(r)||!L(n))return null;const d=new R({x:r,y:n,spatialReference:e||k.WGS84});return o&&(d.z=o,d.hasZ=!0),d}function L(t){return typeof t=="number"&&isFinite(t)}function H(t){return!!t&&L(t.x)&&L(t.y)}function z(t,e){if(t.spatialReference.isGeographic&&e){const[i,r]=He([t.x,t.y],e);return`${i}, ${r}`}return`${t.x.toFixed(3)}, ${t.y.toFixed(3)}`}let g=class extends Z{constructor(t){super(t),this.conversionInfo=null,this.coordinateSegments=null,this._currentPattern=void 0,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){return(this._currentPattern||this.defaultPattern)??""}set currentPattern(t){this._currentPattern=t}get label(){return this.name??""}set label(t){this._overrideIfSome("label",t)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){var t;return this.name==="basemap"?this._viewSpatialReference:((t=this.conversionInfo)==null?void 0:t.spatialReference)??k.WGS84}set spatialReference(t){this._overrideIfSome("spatialReference",t)}get _viewSpatialReference(){var t,e;return((e=(t=this.viewModel)==null?void 0:t.view)==null?void 0:e.spatialReference)??k.WGS84}get _additionalCharactersPattern(){const t=this.coordinateSegments;if(!t)return null;const e=t.map(r=>r.alias),i=this.currentPattern.replaceAll(new RegExp(`["nsew${e.join()}]`,"gi"),"").replaceAll(" ","");return new RegExp(`[${i}]`,"g")}get test(){}async convert(t){var r;if(!H(t))throw new G("format:invalid-point","Could not convert invalid point.",{point:t});const e=(r=this.conversionInfo)==null?void 0:r.convert;if(e)return Promise.resolve().then(()=>e(t));const i=await this._project(t,this.spatialReference);return{location:i,coordinate:await this._getCoordinate(i)}}getConversionStrategy(){var e,i;const t=this._viewSpatialReference;return(e=this.conversionInfo)!=null&&e.convert||(i=this.viewModel)!=null&&i.formatterAvailable||this.name==="xy"&&(t.isWebMercator||t.isWGS84)||this.name==="basemap"?"client":"server"}getDisplayCoordinate(t){if(!t)return null;if(!this.coordinateSegments||!this.currentPattern)return t;let e=this.currentPattern;const i=this._getSegmentMatches(t,!1);for(let r=this.coordinateSegments.length-1;r>=0;r--){const n=this.coordinateSegments[r];e=e.replace(n.alias,i[r])}return e}_parseUserInput(t){const{defaultPattern:e,_additionalCharactersPattern:i,coordinateSegments:r}=this;if(!e||!i)return"";let n=e.replace(i,"");t=t.replace(i,"");const o=this._getSegmentMatches(t,!0);if(r)for(let d=r.length-1;d>=0;d--){const p=r[d];n=n.replace(p.alias,o[d])}return n}_getSegmentMatches(t,e){const i=new Array,{coordinateSegments:r}=this;if(!r)return i;for(let n=0;n<r.length;n++){const o=r[n],d=t.match(o.searchPattern);if(!d){i.push("");continue}let p=d[0];if(t=t.replace(p,"").trim(),o.substitution){const h=e?o.substitution.input(p):o.substitution.output(p);h&&(p=`${h}`)}i.push(p)}return i}async reverseConvert(t){var n,o;const e=this._parseUserInput(t),i=(n=this.conversionInfo)==null?void 0:n.reverseConvert;let r;if(i)r=i(e);else if(this.name==="xy"||this.name==="basemap")r=ze(e,this.spatialReference);else if((o=this.viewModel)!=null&&o.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":r=Ue(e,this.spatialReference);break;case"mgrs":{r=je(e,this.spatialReference,"automatic");break}case"utm":{r=Ve(e,this.spatialReference,"latitude-band-indicators");break}case"usng":r=Ae(e,this.spatialReference);break;default:r=null}if(!r)throw new G("format:invalid-input","Could not parse input into point.",{userInput:t});return this._project(r,this._viewSpatialReference)}async _getCoordinate(t){var i,r,n;const e=((r=(i=this.viewModel)==null?void 0:i.view)==null?void 0:r.scale)??0;if(!H(t))throw new G("format:invalid-point","Could not transform invalid point into coordinate.",{point:t});if((n=this.viewModel)!=null&&n.formatterAvailable||this.name==="basemap"||this.name==="xy")switch(this.name){case"dd":case"ddm":case"dms":{const o=ie(e);return qe(t,this.name,o)}case"mgrs":return Be(t,"automatic",5,!1);case"usng":return Ne(t,5,!1);case"utm":return We(t,"latitude-band-indicators",!0);default:return z(t,e)}return z(t,e)}async _project(t,e){var i,r;if(pe(t.spatialReference,e)||!e)return t;if((i=this.viewModel)!=null&&i.formatterAvailable&&he())return X(t,e);if(!((r=this.viewModel)!=null&&r.formatterAvailable)){const n=ue(t,e);if(n!=null)return n}return null}};s([a()],g.prototype,"conversionInfo",void 0),s([a()],g.prototype,"coordinateSegments",void 0),s([a()],g.prototype,"currentPattern",null),s([a()],g.prototype,"_currentPattern",void 0),s([a()],g.prototype,"label",null),s([a()],g.prototype,"defaultPattern",void 0),s([a({readOnly:!0})],g.prototype,"hasDisplayProperties",null),s([a()],g.prototype,"name",void 0),s([a({type:k})],g.prototype,"spatialReference",null),s([a()],g.prototype,"viewModel",void 0),s([a({readOnly:!0})],g.prototype,"_viewSpatialReference",null),s([a({readOnly:!0})],g.prototype,"_additionalCharactersPattern",null),g=s([M("esri.widgets.CoordinateConversion.support.Format")],g);De().decimal;const Je="°‎",re=t=>{if(t==null||isNaN(t))return 0;const e=t+180;return Math.trunc(Y(e,360))},Ke=t=>{let e=t;return e==null?0:(typeof e=="string"&&(e=parseInt(e,10)),isNaN(e)?0:Y(Math.trunc(e),360)-180)},J=(t,e)=>{if(!t||e.length<3)return;const[i,r,n,o]=e,[d,p]=o===void 0?[1,.25]:[o,.25*o];t.majorLineColor=v.fromArray([i,r,n,d]),t.minorLineColor=v.fromArray([i,r,n,p])},K=Symbol("grid-interactivity");let c=class extends ge.EventedAccessor{constructor(e){super(e),this._drawGraphicTool=null,this._crosshairLabel=null,this._crosshairItem=null,this.snappingManager=null,this.snappingOptions=null,this.view=null,this.placementDisabled=!1,this._mostRecentlyShownGrid=null,this._sketchedVertexCount=0}initialize(){this.addHandles([me(()=>!this.displayEnabled,()=>{this.interactivePlacementState=null}),E(()=>{var e;return(e=this.view)==null?void 0:e.viewpoint},()=>{this._renderOverlays()}),E(()=>{var e;return(e=this.snappingOptions)==null?void 0:e.gridEnabled},e=>{e!=null&&this.trySetDisplayEnabled(e)}),E(()=>{var e;return(e=this.view)==null?void 0:e.grid},(e,i)=>{this._mostRecentlyShownGrid=!e&&i?i:null})])}destroy(){var e,i,r,n;this._resetGridPlacementState(),this._crosshairItem&&((i=(e=this.view)==null?void 0:e.overlay)==null||i.removeItem(this._crosshairItem),this._crosshairItem=D(this._crosshairItem)),this._crosshairLabel&&((n=(r=this.view)==null?void 0:r.overlay)==null||n.removeItem(this._crosshairLabel),this._crosshairLabel=D(this._crosshairLabel))}get displayEnabled(){var e;return!!((e=this.view)!=null&&e.grid)}get dynamicScaling(){var e;return((e=this.grid)==null?void 0:e.dynamicScaling)??!1}set dynamicScaling(e){this.grid&&(this.grid.dynamicScaling=e)}get grid(){var e;return((e=this.view)==null?void 0:e.grid)??this._mostRecentlyShownGrid}set gridColor(e){this._set("gridColor",e);const[i,r,n,o]=e.toArray();J(this.grid,[i,r,n,o/255])}get gridControlsEnabled(){return this.displayEnabled&&!this.interactivePlacementState}set interactivePlacementState(e){this._set("interactivePlacementState",e),this._resetGridPlacementState(),e&&this._startGridManipulation(e)}get majorLineInterval(){var e;return((e=this.grid)==null?void 0:e.majorLineInterval)??10}set majorLineInterval(e){this.grid&&(this.grid.majorLineInterval=e<1?1:e>15?15:e)}get rotateWithMap(){var e;return((e=this.grid)==null?void 0:e.rotateWithMap)??!1}set rotateWithMap(e){this.grid&&(this.grid.rotateWithMap=e)}get rotation(){var e;return((e=this.grid)==null?void 0:e.rotation)??-180}set rotation(e){this.grid&&(this.grid.rotation=e)}get snappingEnabled(){var e;return(this.grid&&((e=this.snappingOptions)==null?void 0:e.gridEnabled))??!1}set snappingEnabled(e){const{snappingOptions:i}=this;i&&(i.gridEnabled=e)}get spacing(){var e;return((e=this.grid)==null?void 0:e.spacing)??1}set spacing(e){this.grid&&e>0&&(this.grid.spacing=e)}get unit(){var e;return(e=this.grid)==null?void 0:e.units}set unit(e){this.grid&&(this.grid.units=e)}get gridOutOfScale(){return!this.dynamicScaling&&this._pixelsPerStride!=null&&this._pixelsPerStride<Ee}get effectiveSpacingAfterDynamicScaling(){var e;return this.majorLineInterval<1||!this.dynamicScaling||!this.view||this._pixelsPerStride==null||!((e=this.grid)!=null&&e.spacing)?null:this.grid.spacing*Re(this.majorLineInterval,this._pixelsPerStride,this.dynamicScaling)}get numericSpacingInputShouldBeVisible(){var e;return!!((e=this.view)!=null&&e.spatialReference)&&ke(this.view.spatialReference)}get _metersPerSRUnit(){if(!(this.view&&this.displayEnabled&&this.grid&&ve(this.grid.center.spatialReference,this.view.spatialReference)))return null;const e=X(this.grid.center,this.view.spatialReference);return Le(e)}get _pixelsPerStride(){var n;if(!((n=this.view)!=null&&n.scale)||!this.displayEnabled||!this.grid||this._metersPerSRUnit==null)return null;const e=this.grid,{scale:i,spatialReference:r}=this.view;return W(e.spacing,e.units,"meters")/(this._metersPerSRUnit*_e(i,r))}get _isPlacing(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return e==="place"||e==="interactive"&&this._sketchedVertexCount===0}get _isRotating(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return e==="rotate"||e==="interactive"&&this._sketchedVertexCount===1}get _isScaling(){return this._drawGraphicTool?this.interactivePlacementState==="interactive"&&this._sketchedVertexCount===1:!1}togglePlacementState(e){this.interactivePlacementState=this.interactivePlacementState===e?null:e}trySetDisplayEnabled(e){const{view:i}=this;if(i!=null&&i.ready)if(!i.grid&&e)if(this._mostRecentlyShownGrid)i.grid=this._mostRecentlyShownGrid;else{const r=this.defaultUnit==="imperial"?"feet":"meters";i.grid=new _({units:r,center:i.center??new R,rotateWithMap:!0}),J(this.grid,[115,115,115])}else e||(i.grid=null);else ye.getLogger(this).warn("Attempting to enable grid display while view is not ready")}startPlacement(e){const{view:i,snappingManager:r}=this;if(!i)return;this._set("interactivePlacementState",e),this._sketchedVertexCount=0;const n=new Oe({view:i,graphicProperties:{attributes:{[N]:N}},sketchOptions:{tooltips:{enabled:!0,visibleElements:{direction:!1,rotation:!1,totalLength:!1,elevation:!1,distance:!1,area:!1}}},geometryType:"polyline",mode:"click",snapToScene:!1,snappingManager:r,forceUniformSize:!0,centered:!1,cursor:this.interactivePlacementState==="interactive"||this.interactivePlacementState==="place"?"none":null,regularVerticesSymbol:void 0,activeVertexSymbol:Qe,activeLineSymbol:Q,graphicSymbol:Q});this._drawGraphicTool=n,i.addAndActivateTool(n),this._renderOverlays(),this.addHandles([n.on("cursor-update",o=>this._onCursorUpdate(o)),n.on("complete",()=>this._onDrawComplete()),n.on("vertex-add",o=>this._onVertexAdd(o,e))],K)}async _startGridManipulation(e){const{view:i}=this;if(!i)return void(this.interactivePlacementState=null);const r=new CustomEvent("before-placement",{cancelable:!0});this.emit("before-placement",r),r.defaultPrevented||this.startPlacement(e)}_onCursorUpdate(e){var i;try{if(this._isPlacing){const r=e.vertices[0].coordinates;return void this._handlePlace(r)}if(this._drawGraphicTool.cursor=null,this._isRotating&&this._handleRotate(e.vertices[0].coordinates),this._isScaling){const r=(i=this._drawGraphicTool)==null?void 0:i.drawOperation.cursorVertex;this._handleScale(r)}}finally{this._renderOverlays()}}_onDrawComplete(){this._drawGraphicTool.cursor=null,this.interactivePlacementState=null}_onVertexAdd(e,i){const r=e.vertices[0].coordinates;this._isPlacing&&this._handlePlace(r),this._isRotating&&this._sketchedVertexCount>0&&this._handleRotate(r),this._isScaling&&this._sketchedVertexCount>0&&this._handleScale(B(r[0],r[1],void 0,this.view.spatialReference)),this._sketchedVertexCount++,this._drawGraphicTool.cursor=null,this._sketchedVertexCount!==2&&i==="interactive"||(this.interactivePlacementState=null),this._renderOverlays()}_handlePlace(e){const{grid:i,view:r}=this;i&&r&&(i.center=new R({x:e[0],y:e[1],spatialReference:r.spatialReference}))}_handleRotate(e){var U;const{grid:i,view:r}=this;if(!i||!r)return;(U=this._drawGraphicTool)==null||U.sketchOptions.tooltips.set("enabled",!1);const{x:n,y:o}=i.center,[d,p]=e,h=r.toScreen(i.center,{pickClosestTarget:!0}),u=h&&r.toMap(h),w=r.toScreen(B(d,p,void 0,r.spatialReference),{pickClosestTarget:!0}),C=w&&r.toMap(w),P=u?u.x:n,O=u?u.y:o,x=P-(C?C.x:d),V=O-(C?C.y:p);if(x===0&&V===0)return;const se=Math.atan2(V,x),j=be(se),ae=i.rotateWithMap,oe=r.viewpoint.rotation??0,le=ae?j:j-oe;i.rotation=Math.fround(le)%360}_handleScale(e){const{view:i,grid:r,_drawGraphicTool:n,interactivePlacementState:o,_metersPerSRUnit:d}=this;if(!(e&&i&&r&&n&&d))return;n.sketchOptions.tooltips.enabled=!1;const p=o==="interactive"?r.center:n.drawOperation.firstVertex;if(!p||!e)return;const h=i==null?void 0:i.toScreen(p),u=h&&i.toMap(h),w=i==null?void 0:i.toScreen(e),C=u??p,P=(w&&i.toMap(w))??e,O=Math.sqrt((C.x-P.x)**2+(C.y-P.y)**2),x=W(O*d,"meters",r.units);this.spacing=x}_renderOverlays(){this._renderCrosshairOverlay(),this._renderTextOverlay()}_renderTextOverlay(){const{grid:e,view:i,_drawGraphicTool:r}=this,n=this._getCrosshairLabel();if(!(e&&(i!=null&&i.overlay)&&r&&n))return;const o=i.toScreen(e.center,{pickClosestTarget:!0});o&&(n.position=[o.x+12,o.y+12]),this._isRotating?(n.text=`${re(e.rotation)}${Je}`,n.visible=!0):n.visible=!1}_renderCrosshairOverlay(){const{grid:e,view:i,_drawGraphicTool:r}=this;if(!e||!(i!=null&&i.overlay)||!r)return;const n=this._getCrosshair();if(!n)return;const o=i.toScreen(e.center);o&&(n.x=o.x,n.y=o.y,n.rotation=e.rotateWithMap?i.viewpoint.rotation-e.rotation:-e.rotation,n.visible=!!r)}_getCrosshairLabel(){if(this._crosshairLabel)return this._crosshairLabel;const{grid:e,view:i,_drawGraphicTool:r}=this;if(!e||!(i!=null&&i.overlay)||!r)return null;const n=new Ge({anchor:"top-left",fontSize:10,textColor:new v([21,21,21]),backgroundColor:new v([248,248,248]),padding:8,borderRadius:20});return i.overlay.addItem(n),this._crosshairLabel=n,n}_getCrosshair(){var r;const{_crosshairItem:e,view:i}=this;return i!=null&&i.overlay?e&&i.overlay.items.includes(e)?e:(this._crosshairItem=new Fe({color:i.effectiveTheme.accentColor,thickness:4,length:36,visible:!0}),(r=i.overlay)==null||r.addItem(this._crosshairItem),this._crosshairItem):null}_resetGridPlacementState(){var e,i;this.removeHandles(K),this._crosshairItem&&(this._crosshairItem.visible=!1),this._crosshairLabel&&(this._crosshairLabel.visible=!1),this._drawGraphicTool&&(((e=this.view)==null?void 0:e.activeTool)===this._drawGraphicTool&&(this.view.activeTool=null),(i=this.view)==null||i.tools.remove(this._drawGraphicTool)),this._drawGraphicTool=D(this._drawGraphicTool)}};s([a(Te)],c.prototype,"defaultUnit",void 0),s([a({readOnly:!0})],c.prototype,"displayEnabled",null),s([a()],c.prototype,"dynamicScaling",null),s([a()],c.prototype,"grid",null),s([a({type:v})],c.prototype,"gridColor",null),s([a({readOnly:!0})],c.prototype,"gridControlsEnabled",null),s([a()],c.prototype,"interactivePlacementState",null),s([a()],c.prototype,"majorLineInterval",null),s([a()],c.prototype,"rotateWithMap",null),s([a()],c.prototype,"rotation",null),s([a()],c.prototype,"snappingEnabled",null),s([a()],c.prototype,"snappingManager",void 0),s([a({type:we})],c.prototype,"snappingOptions",void 0),s([a()],c.prototype,"spacing",null),s([a()],c.prototype,"unit",null),s([a()],c.prototype,"view",void 0),s([a({readOnly:!0})],c.prototype,"gridOutOfScale",null),s([a({readOnly:!0})],c.prototype,"effectiveSpacingAfterDynamicScaling",null),s([a({readOnly:!0})],c.prototype,"numericSpacingInputShouldBeVisible",null),s([a()],c.prototype,"placementDisabled",void 0),s([a()],c.prototype,"_metersPerSRUnit",null),s([a()],c.prototype,"_pixelsPerStride",null),s([a()],c.prototype,"_isPlacing",null),s([a()],c.prototype,"_isRotating",null),s([a()],c.prototype,"_isScaling",null),s([a()],c.prototype,"_mostRecentlyShownGrid",void 0),s([a()],c.prototype,"_sketchedVertexCount",void 0),c=s([M("esri.widgets.support.GridControls.GridControlsViewModel")],c);const ne=c,Q=new ee({width:0}),Qe=new fe({color:v.fromArray([0,0,0,0]),outline:new ee({color:v.fromArray([0,0,0,0])})}),b="esri-grid-controls",f={base:b,borderedSwitch:`${b}__switch--bordered`,container:`${b}__container`,numericInputsContainer:`${b}__numeric-inputs__container`,tilegroup:`${b}__tilegroup`,tile:`${b}__tile`,tileDisabled:`${b}__tile--disabled`,tileContent:`${b}__tile__content`,suffixedInputContainer:`${b}__input-with-suffix__container`,inlineIcon:`${b}__inline-icon`},$={widgetIcon:"grid-unit",gridTheme:{light:"circle",dark:"circle-area",custom:"palette"},placementState:{interactive:"maximum-territory-distance",place:"move",rotate:"rotate"},warning:"exclamation-mark-triangle"},T=v.fromArray([115,115,115]),A=v.fromArray([200,200,200]),Ze=["interactive","place","rotate"];let m=class extends Se{constructor(t,e){super(t,e),this.customColor=null,this.messages=null,this.messagesUnits=null,this.viewModel=new ne,this.visibleElements=new te}initialize(){this.addHandles([E(()=>{var t,e;return(e=(t=this.view)==null?void 0:t.grid)==null?void 0:e.majorLineColor},t=>{!t||T.equals(t)||A.equals(t)||(this.customColor=t)},Ce)])}loadDependencies(){return Promise.all([$e({action:()=>S(()=>import("./index-DSua8dRv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])),"action-bar":()=>S(()=>import("./index-BhzU_LgF.js"),__vite__mapDeps([15,1,2,3,4,5,6,7,8,9,0,10,11,12,13,14,16,17,18,19,20,21,22,23,24,25,26,27])),label:()=>S(()=>import("./index-Duq0jvYY.js"),__vite__mapDeps([28,2,3,29,7])),icon:()=>S(()=>import("./index-QBdcCKqQ.js"),__vite__mapDeps([6,2,3,7,8,9])),popover:()=>S(()=>import("./index-w53CkBmw.js").then(t=>t.i),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,0,10,11,12,13,14,17,18,19,20,21,22,23])),tooltip:()=>S(()=>import("./index-CQR84glj.js"),__vite__mapDeps([30,2,3,12,11,17,7,18,4,19,21,10])),"color-picker":()=>S(()=>import("./index-BhCku7kx.js"),__vite__mapDeps([31,2,3,10,11,7,32,6,8,9,33,34,35,36,12,37,13,29,14,38,39,5,40,23,41,1,4,42,20,43,44,45,46,18])),"input-number":()=>S(()=>import("./index-B8IgFtlE.js"),__vite__mapDeps([40,6,2,3,7,8,9,33,34,36,11,10,12,37,13,23,29,14,41,38,39,5]))}),Me()])}get icon(){return $.widgetIcon}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages.widgetLabel}set label(t){this._overrideIfSome("label",t)}get snappingManager(){return this.viewModel.snappingManager}set snappingManager(t){this.viewModel.snappingManager=t}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(t){this.viewModel.snappingOptions=t}get theme(){var e;const t=(e=this.viewModel.grid)==null?void 0:e.majorLineColor;return t?T.equals(t)?"dark":A.equals(t)?"light":"custom":null}set theme(t){const{viewModel:e,customColor:i,view:r}=this;switch(t){case"light":e.gridColor=A;break;case"dark":e.gridColor=T;break;case"custom":e.gridColor=i??(r==null?void 0:r.effectiveTheme.accentColor)??T}}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){return l("div",{"aria-label":this.label,class:this.classes(f.base,q.widget,q.panel)},l("div",{class:f.container},this._renderContent()))}_renderContent(){const{visibleElements:t}=this;return[t.gridEnabledToggle?this._renderEnabledToggle():null,t.placementButtons?this._renderGridPlacementButtons():null,t.numericInputs?this._renderNumericInputs():null,t.lineIntervalInput?this._renderIntervalInput():null,t.gridSnapEnabledToggle&&this.viewModel.snappingOptions?this._renderSnappingToggle():null,t.dynamicScaleToggle?this._renderDynamicScaleToggle():null,t.rotateWithMapToggle?this._renderRotateToggle():null,t.colorSelection?this._renderColorSelection():null]}_renderGridPlacementButtons(){const{interactivePlacementState:t,placementDisabled:e,gridControlsEnabled:i}=this.viewModel,r=e||!i;return l("calcite-label",{key:"grid-placement-buttons",scale:"s"},this.messages.placementOptions,l("calcite-action-bar",{expandDisabled:!0,layout:"horizontal"},Ze.map(n=>this._renderPlacementModeButton(n,r,t))))}_renderPlacementModeButton(t,e,i){const r=this.messages.placementState[t],n=`__placement-action-${t}`;return l("div",null,l("calcite-action",{active:i===t,alignment:"center",disabled:e,icon:$.placementState[t],id:n,onclick:()=>this.viewModel.togglePlacementState(t),text:r}),l("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:n},r))}_renderNumericInputs(){const{rotation:t,spacing:e,effectiveSpacingAfterDynamicScaling:i,numericSpacingInputShouldBeVisible:r,unit:n="meters"}=this.viewModel,o=this.messagesUnits.units[n].abbr,d=this.viewModel.gridControlsEnabled,p=i!=null&&i!==this.viewModel.spacing,h=`__spacing_input_scaled-${this.id}`;return l("div",{class:this.classes(f.numericInputsContainer)},[r?l("calcite-label",{key:"spacing-label",scale:"s"},l("span",null,this.messages.inputLabel.spacing,p?l("calcite-icon",{class:this.classes(f.inlineIcon),icon:$.warning,id:h,scale:"s",tabIndex:0}):void 0),l("div",{class:f.suffixedInputContainer},l("calcite-input-number",{disabled:!d,numberButtonType:"none",suffixText:o,value:`${e==null?void 0:e.toFixed(2)}`,onCalciteInputNumberChange:({currentTarget:u})=>{const w=parseFloat(u.value);this.viewModel.spacing=w,w!==this.viewModel.spacing&&(u.value=`${this.viewModel.spacing}`)}}),p?l("calcite-tooltip",{overlayPositioning:"fixed",placement:"leading",referenceElement:h},Pe(this.messages.warnings.dynamicSpacing,{actualSpacingIncludingUnit:xe(this.messagesUnits,i,n,2,"plural")})):void 0)):void 0,l("calcite-label",{key:"angle-label",scale:"s"},this.messages.inputLabel.angle,l("calcite-input-number",{disabled:!d,integer:!0,numberButtonType:"none",suffixText:this.messagesUnits.units.degrees.abbr,value:`${re(t)}`,onCalciteInputNumberChange:({currentTarget:u})=>this.viewModel.rotation=Ke(u.value)}))])}_renderIntervalInput(){const{majorLineInterval:t,gridControlsEnabled:e}=this.viewModel;return l("div",{class:this.classes(f.numericInputsContainer)},l("calcite-label",{scale:"s"},this.messages.inputLabel.interval,l("calcite-input-number",{disabled:!e,integer:!0,max:15,min:1,numberButtonType:"vertical",value:`${t}`,onCalciteInputNumberChange:({currentTarget:i})=>{const r=Number.parseInt(i.value,10);this.viewModel.majorLineInterval=r,r!==this.viewModel.majorLineInterval&&(i.value=`${this.viewModel.majorLineInterval}`)}})))}_renderSnappingToggle(){const{snappingOptions:t,gridControlsEnabled:e}=this.viewModel;return l(I,{checked:!!((t==null?void 0:t.gridEnabled)??!1),disabled:!(e&&t),key:"grid-snap-enabled-toggle",label:this.messages.switchLabel.snap,onChange:i=>{var r;return(r=this.viewModel.snappingOptions)==null?void 0:r.set("gridEnabled",i)}})}_renderDynamicScaleToggle(){const{viewModel:t,messages:e}=this,i=this.visibleElements.outOfScaleWarning&&t.gridOutOfScale;return l(I,{checked:t.dynamicScaling,disabled:!t.gridControlsEnabled,hint:i?e.warnings.outOfScale:void 0,hintIcon:$.warning,hintKind:"warning",key:`grid-dynamic-scale-toggle-${this.id}`,label:e.switchLabel.scaling,onChange:r=>t.dynamicScaling=r})}_renderRotateToggle(){const{gridControlsEnabled:t,rotateWithMap:e}=this.viewModel;return l(I,{checked:e,disabled:!t,key:"grid-rotate-map-toggle",label:this.messages.switchLabel.rotateWithMap,onChange:i=>this.viewModel.rotateWithMap=i})}_renderEnabledToggle(){return l("div",{class:f.borderedSwitch},l(I,{checked:this.viewModel.displayEnabled,disabled:!!this.viewModel.interactivePlacementState,key:"grid-enabled-toggle",label:this.messages.switchLabel.display,onChange:t=>this.viewModel.trySetDisplayEnabled(t)}))}_renderColorSelection(){const{customColor:t}=this,e=`${this.id}--custom-grid-color-button`;return l("calcite-label",{scale:"s"},this.messages.inputLabel.theme,l("div",{class:f.tilegroup},[this._renderThemeTile({value:"dark"}),this._renderThemeTile({value:"light"}),this._renderThemeTile({value:"custom",id:e}),l("calcite-popover",{autoClose:!0,label:this.messages.gridLineColorPopoverLabel,overlayPositioning:"fixed",referenceElement:e},l("calcite-color-picker",{alphaChannel:!0,savedDisabled:!0,value:(t==null?void 0:t.toHex({digits:8}))??"#000000ff",onCalciteColorPickerChange:i=>{const r=v.fromHex(i.currentTarget.value);r&&(this.customColor=r,this.theme="custom")}}))]))}_renderThemeTile(t){const{theme:e}=this,{value:i}=t,r=this.messages.gridTheme[i],n=`${this.id}--theme_tile_${i}`,o=`${n}__label`,d=$.gridTheme[i],p=this.viewModel.gridControlsEnabled;return l("div",{class:Ie({[f.tile]:!0,[f.tileDisabled]:!p}),id:t.id,role:"button"},l("input",{"aria-labelledby":o,checked:e===i,disabled:!p,id:n,name:`${this.id}--theme`,onchange:h=>{var u;this.theme=i,(u=h.target)==null||u.focus()},tabIndex:0,type:"radio"}),l("div",{class:f.tileContent},l("calcite-icon",{icon:d,scale:"l"}),l("calcite-label",{for:n,id:o},r)))}};s([a({type:v})],m.prototype,"customColor",void 0),s([a()],m.prototype,"icon",null),s([a()],m.prototype,"label",null),s([a(),F("esri/widgets/support/GridControls/t9n/GridControls")],m.prototype,"messages",void 0),s([a(),F("esri/core/t9n/Units")],m.prototype,"messagesUnits",void 0),s([a()],m.prototype,"snappingManager",null),s([a()],m.prototype,"snappingOptions",null),s([a()],m.prototype,"theme",null),s([a()],m.prototype,"view",null),s([a({type:ne})],m.prototype,"viewModel",void 0),s([a({type:te,nonNullable:!0})],m.prototype,"visibleElements",void 0),m=s([M("esri.widgets.support.GridControls")],m);const Et=m;export{Et as default};
